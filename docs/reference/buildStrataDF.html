<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Builds the "strata" dataframe containing information on target variables Y's
distributions in the different strata, starting from sample data or from a frame — buildStrataDF • SamplingStrata</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Builds the "strata" dataframe containing information on target variables Y's
distributions in the different strata, starting from sample data or from a frame — buildStrataDF" />

<meta property="og:description" content="This function allows to build the information regarding strata in the population required as
an input by the algorithm of Bethel for the optimal allocation.
In order to estimate means and standard deviations for target variables Y's, we need data coming from:
(1) a previous round of the survey whose sample we want to plan;
(2) sample data from a survey with variables that are proxy to the ones we are interested to;
(3) a frame containing values of Y's variables (or proxy variables) for all the population.
In all cases, each unit in the dataset must contain auxiliary information (X's variables)
and also target variables Y's (or proxy variables) values: under these conditions it is possible 
to build the dataframe &quot;strata&quot;, containing information on the distribution of Y's in the different strata 
(namely, means and standard deviations), together with information on strata (total population, 
if it is to be censused or not, the cost per single interview).
If the information is contained in a sample dataset, a variable named WEIGHT is expected to be 
present. In case of a frame, no such variable is given, and the function will define a WEIGHT variable
for each unit, whose value is always '1'.
Missing values for each Y variable will not be taken into account in the computation of means and standard 
deviations (in any case, NA's can be present in the dataset).
The dataframe &quot;strata&quot; is written to an external file (tab delimited, extension &quot;txt&quot;), and will be
used as an input by optimizeStrata." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84499524-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84499524-2');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SamplingStrata</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/interactive_execution.html">Interactive Execution - the SamplingStrata GUI</a>
    </li>
    <li>
      <a href="../articles/noninteractive_execution.html">Non-Interactive Execution from within R</a>
    </li>
    <li>
      <a href="../articles/standalone_execution.html">Standalone Execution and Scheduled Processing</a>
    </li>
    <li>
      <a href="../articles/output.html">Outputs Format and Naming Conventions</a>
    </li>
    <li>
      <a href="../articles/analyze.html">Accessing and Analyzing Processed Data from R</a>
    </li>
    <li>
      <a href="../articles/Products_list.html">Supported MODIS Products</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    faq
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/lbusett/SamplingStrata/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Builds the "strata" dataframe containing information on target variables Y's
distributions in the different strata, starting from sample data or from a frame</h1>
    
    <div class="hidden name"><code>buildStrataDF.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function allows to build the information regarding strata in the population required as
an input by the algorithm of Bethel for the optimal allocation.
In order to estimate means and standard deviations for target variables Y's, we need data coming from:
(1) a previous round of the survey whose sample we want to plan;
(2) sample data from a survey with variables that are proxy to the ones we are interested to;
(3) a frame containing values of Y's variables (or proxy variables) for all the population.
In all cases, each unit in the dataset must contain auxiliary information (X's variables)
and also target variables Y's (or proxy variables) values: under these conditions it is possible 
to build the dataframe "strata", containing information on the distribution of Y's in the different strata 
(namely, means and standard deviations), together with information on strata (total population, 
if it is to be censused or not, the cost per single interview).
If the information is contained in a sample dataset, a variable named WEIGHT is expected to be 
present. In case of a frame, no such variable is given, and the function will define a WEIGHT variable
for each unit, whose value is always '1'.
Missing values for each Y variable will not be taken into account in the computation of means and standard 
deviations (in any case, NA's can be present in the dataset).
The dataframe "strata" is written to an external file (tab delimited, extension "txt"), and will be
used as an input by optimizeStrata.</p>
    
    </div>

    <pre class="usage"><span class='fu'>buildStrataDF</span>(<span class='no'>dataset</span>,<span class='kw'>model</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>progress</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataset</th>
      <td><p>This is the name of the dataframe containing the sampling data, or frame data. 
  It is strictly required that auxiliary information is organised in variables named 
  as X1, X2, ... , Xm (there should be at least one of them) and the target variables 
  are denoted by Y1, Y2, ... , Yn.
  In addition, in case of sample data, a variable named 'WEIGHT' must be present in the dataframe, 
  containing   the weigths associated to each sampling unit</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>In case the Y variables are not directly observed, but are estimated by means of other explicative variables, in order
  to compute the anticipated variance, information on models are given by a dataframe "model" with as many rows as the
  target variables. Each row contains the indication if the model is linear o loglinear, and the values of the model parameters 
  beta, sig2, gamma (&gt; 1 in case of heteroscedasticity). 
  Default is NULL.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>If set to TRUE, a progress bar is visualised during the execution. Default is FALSE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A dataframe containing strata</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Plain example without model</span>
<span class='fu'>data</span>(<span class='no'>swissframe</span>)
<span class='no'>strata</span> <span class='kw'>&lt;-</span> <span class='fu'>buildStrataDF</span>(<span class='kw'>dataset</span><span class='kw'>=</span><span class='no'>swissframe</span>,<span class='kw'>model</span><span class='kw'>=</span><span class='kw'>NULL</span>)</div><div class='output co'>#&gt; 
#&gt; Computations are being done on population data
#&gt; 
#&gt; Number of strata:  641
#&gt; ... of which with only one unit:  389</div><div class='input'><span class='fu'>head</span>(<span class='no'>strata</span>)</div><div class='output co'>#&gt;        STRATO   N       M1        M2        M3       M4       S1       S2
#&gt; 1 1*1*1*1*1*1 184 48.31522  49.40217  61.44022 28.40761 26.81536 28.49831
#&gt; 2 1*1*1*1*1*2   1 98.00000 106.00000 116.00000 43.00000  0.00000  0.00000
#&gt; 3 1*1*1*2*1*1   2 57.00000  64.00000  70.00000 50.00000  4.00000  0.00000
#&gt; 4 1*1*2*1*1*1  11 77.72727  81.18182  92.36364 47.00000 15.24998 18.69768
#&gt; 5 1*2*1*1*1*1   9 58.22222  61.55556  66.77778 36.22222 25.46360 20.27100
#&gt; 6 1*2*1*2*1*1   8 61.00000  68.00000  84.62500 58.37500 24.56624 19.48076
#&gt;         S3       S4 COST CENS DOM1 X1 X2 X3 X4 X5 X6
#&gt; 1 32.63062 14.63922    1    0    1  1  1  1  1  1  1
#&gt; 2  0.00000  0.00000    1    0    1  1  1  1  1  1  2
#&gt; 3  1.00000 15.00000    1    0    1  1  1  1  2  1  1
#&gt; 4 17.03084 11.12736    1    0    1  1  1  2  1  1  1
#&gt; 5 24.89881 15.49751    1    0    1  1  2  1  1  1  1
#&gt; 6 26.35307 26.55625    1    0    1  1  2  1  2  1  1</div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># More complex example with models</span>
<span class='fu'>library</span>(<span class='no'>SamplingStrata</span>)
<span class='fu'>data</span>(<span class='no'>swissmunicipalities</span>)
<span class='no'>swiss</span> <span class='kw'>&lt;-</span> <span class='no'>swissmunicipalities</span>[,<span class='fu'>c</span>(<span class='st'>"HApoly"</span>,<span class='st'>"Surfacesbois"</span>,<span class='st'>"Airind"</span>,<span class='st'>"POPTOT"</span>)]
<span class='no'>Y1</span> <span class='kw'>=</span> <span class='no'>swiss</span>$<span class='no'>Surfacesbois</span>
<span class='no'>X1</span> <span class='kw'>=</span> <span class='no'>swiss</span>$<span class='no'>HApoly</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='fu'>lm</span>( <span class='no'>Y1</span> ~ <span class='no'>X1</span> )
<span class='fu'>summary</span>(<span class='no'>mod1</span>)
<span class='no'>mod1</span>$<span class='no'>coefficients</span>[<span class='fl'>2</span>]
<span class='fu'>summary</span>(<span class='no'>mod1</span>)$<span class='no'>sigma</span>

<span class='no'>Y2</span> <span class='kw'>=</span> <span class='no'>swiss</span>$<span class='no'>Airind</span>
<span class='no'>X2</span> <span class='kw'>=</span> <span class='no'>swiss</span>$<span class='no'>POPTOT</span>
<span class='fu'>plot</span>(<span class='fu'>log</span>(<span class='no'>X2</span>[<span class='no'>X2</span><span class='kw'>&gt;</span><span class='fl'>0</span>]),<span class='fu'>log</span>(<span class='no'>Y2</span>[<span class='no'>X2</span><span class='kw'>&gt;</span><span class='fl'>0</span>]))
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='fu'>lm</span>( <span class='fu'>log</span>(<span class='no'>Y2</span>[<span class='no'>X2</span> <span class='kw'>&gt;</span> <span class='fl'>0</span> <span class='kw'>&amp;</span> <span class='no'>Y2</span><span class='kw'>&gt;</span><span class='fl'>0</span>]) ~ <span class='fu'>log</span>(<span class='no'>X2</span>[<span class='no'>X2</span> <span class='kw'>&gt;</span> <span class='fl'>0</span> <span class='kw'>&amp;</span> <span class='no'>Y2</span><span class='kw'>&gt;</span><span class='fl'>0</span>]) )
<span class='fu'>summary</span>(<span class='no'>mod2</span>)
<span class='no'>mod2</span>$<span class='no'>coefficients</span>[<span class='fl'>2</span>]
<span class='fu'>summary</span>(<span class='no'>mod2</span>)$<span class='no'>sigma</span>

<span class='no'>swiss</span>$<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1</span>:<span class='fu'>nrow</span>(<span class='no'>swiss</span>))
<span class='no'>swiss</span>$<span class='no'>dom</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>frame</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='buildFrameDF.html'>buildFrameDF</a></span>(<span class='no'>swiss</span>,<span class='kw'>id</span><span class='kw'>=</span><span class='st'>"id"</span>,<span class='kw'>X</span><span class='kw'>=</span><span class='st'>"id"</span>,<span class='kw'>Y</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"HApoly"</span>,<span class='st'>"POPTOT"</span>),<span class='kw'>domainvalue</span><span class='kw'>=</span><span class='st'>"dom"</span>)

<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='kw'>NULL</span>
<span class='no'>model</span>$<span class='no'>type</span>[<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='st'>"linear"</span>
<span class='no'>model</span>$<span class='no'>beta</span>[<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>mod1</span>$<span class='no'>coefficients</span>[<span class='fl'>2</span>]
<span class='no'>model</span>$<span class='no'>sig2</span>[<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fu'>summary</span>(<span class='no'>mod1</span>)$<span class='no'>sigma</span>
<span class='no'>model</span>$<span class='no'>gamma</span>[<span class='fl'>1</span>] <span class='kw'>=</span> <span class='fl'>2</span>
<span class='no'>model</span>$<span class='no'>type</span>[<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='st'>"loglinear"</span>
<span class='no'>model</span>$<span class='no'>beta</span>[<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>mod2</span>$<span class='no'>coefficients</span>[<span class='fl'>2</span>]
<span class='no'>model</span>$<span class='no'>sig2</span>[<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fu'>summary</span>(<span class='no'>mod2</span>)$<span class='no'>sigma</span>
<span class='no'>model</span>$<span class='no'>gamma</span>[<span class='fl'>2</span>] <span class='kw'>=</span> <span class='fl'>NA</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'>as.data.frame</span>(<span class='no'>model</span>)

<span class='no'>strata</span> <span class='kw'>&lt;-</span> <span class='fu'>buildStrataDF</span>(<span class='kw'>dataset</span><span class='kw'>=</span><span class='no'>frame</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Giulio Barcaroli

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Giulio Barcaroli.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

